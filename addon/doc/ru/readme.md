# Vision Assistant Pro (Визуальный помощник Pro)

**Vision Assistant Pro** — это продвинутый многофункциональный ИИ-ассистент для NVDA. Он использует модели Gemini от Google для предоставления интеллектуального озвучивания экрана, перевода, голосового ввода и анализа документов.

*Это дополнение было выпущено для сообщества в честь Международного дня людей с ограниченными возможностями.*

## 1. Установка и настройка

Перейдите в **Меню NVDA > Параметры > Настройки > Vision Assistant Pro**.

*   **Ключ API:** Обязателен. По умолчанию поле скрыто для безопасности (используйте «Показать ключ API», чтобы увидеть). Получите бесплатный ключ в [Google AI Studio](https://aistudio.google.com/).
*   **Модель:** Выберите между быстрыми бесплатными моделями Flash или высокоинтеллектуальными моделями Pro в зависимости от ваших потребностей.
*   **Языки:** Установите исходный язык, целевой язык и язык ответов ИИ.
*   **Умная замена:** Автоматически меняет языки местами, если исходный текст соответствует целевому языку.
*   **Прямой вывод:** Пропускает окно чата и сразу озвучивает ответ.
*   **Интеграция с буфером обмена:** Автоматически копирует ответ ИИ в буфер обмена.

## 2. Командный слой и сочетания клавиш

Чтобы избежать конфликтов клавиш, это дополнение использует **Командный слой**.
1.  Нажмите **NVDA + Shift + V** (Главная клавиша), чтобы активировать слой (вы услышите звуковой сигнал).
2.  Отпустите клавиши, затем нажмите одну из следующих одиночных клавиш:

| Клавиша         | Функция                      | Описание                                                                 |
|-----------------|------------------------------|-------------------------------------------------------------------------|
| **T**           | Умный переводчик            | Переводит текст под курсором навигатора или выделенный текст.          |
| **Shift + T**   | Перевод из буфера обмена     | Переводит текущее содержимое буфера обмена.                             |
| **R**           | Обработка текста             | Суммаризация, исправление грамматики, объяснение или **Пользовательские запросы**. |
| **V**           | Анализ объекта               | Описывает текущий объект навигатора.                                    |
| **O**           | Анализ всего экрана          | Анализирует layout и содержимое всего экрана.                           |
| **Shift + V**   | Анализ онлайн-видео          | Анализ видео с **YouTube** или **Instagram** по URL.                   |
| **D**           | Анализ документа             | Чат с файлами PDF/TXT/MD/PY.                                            |
| **F**           | Распознавание текста из файла| Прямое распознавание текста из файлов изображений/PDF/TIFF (поддержка многостраничных TIFF). |
| **A**           | Транскрипция аудио           | Расшифровка файлов MP3/WAV/OGG.                                         |
| **C**           | Решение CAPTCHA              | Автоматически захватывает и решает CAPTCHA.                             |
| **S**           | Умный голосовой ввод         | Преобразует речь в текст. Нажмите для начала записи, ещё раз — для остановки/ввода. |
| **L**           | Отчёт о состоянии            | Озвучивает текущий статус (например, «Загрузка...», «Ожидание»).        |
| **U**           | Проверка обновлений          | Проверяет наличие новой версии на GitHub.                               |

## 3. Пользовательские запросы и переменные

Создавайте команды в Настройках: `Имя:Текст запроса` (разделяйте `|` или новой строкой).

### Доступные переменные

| Переменная       | Описание                                      | Тип ввода          |
|------------------|-----------------------------------------------|--------------------|
| `[selection]`    | Выделенный в данный момент текст             | Текст              |
| `[clipboard]`    | Содержимое буфера обмена                      | Текст              |
| `[screen_obj]`   | Скриншот объекта навигатора                   | Изображение        |
| `[screen_full]`  | Скриншот всего экрана                         | Изображение        |
| `[file_ocr]`     | Выберите изображение/PDF/TIFF (по умолчанию «Извлечь текст»)| Изображение, PDF, TIFF |
| `[file_read]`    | Выберите текстовый документ                   | TXT, Код, PDF      |
| `[file_audio]`   | Выберите аудиофайл                            | MP3, WAV, OGG      |

### Примеры пользовательских запросов

*   **Быстрый OCR:** `Мой OCR:[file_ocr]`
*   **Перевод изображения:** `Перевод изображения:Извлеки текст с этого изображения и переведи на персидский. [file_ocr]`
*   **Анализ аудио:** `Суммаризация аудио:Прослушайте эту запись и выделите основные моменты. [file_audio]`
*   **Отладка кода:** `Отладка:Найди ошибки в этом кода и объясни их: [selection]`

**Примечание:** Для работы всех функций ИИ требуется активное интернет-соединение. Многостраничные TIFF обрабатываются автоматически.

## Изменения в версии 3.5.0
*   **Командный слой:** Введена система Командного слоя (по умолчанию: `NVDA+Shift+V`) для группировки сочетаний клавиш под одной главной клавишей. Например, вместо нажатия `NVDA+Control+Shift+T` для перевода теперь нужно нажать `NVDA+Shift+V`, а затем `T`.
*   **Анализ онлайн-видео:** Добавлена новая функция для анализа видео с YouTube и Instagram непосредственно по предоставленному URL.

## Изменения в версии 3.1.0
*   **Режим прямого вывода:** Добавлена опция пропуска диалогового окна чата и прямого озвучивания ответов ИИ для более быстрого и плавного взаимодействия.
*   **Интеграция с буфером обмена:** Добавлена новая настройка для автоматического копирования ответов ИИ в буфер обмена.

## Изменения в версии 3.0

*   **Новые языки:** Добавлены переводы на **персидский** и **вьетнамский** языки.
*   **Расширенные модели ИИ:** Реорганизован список выбора моделей с понятными префиксами (`[Free]`, `[Pro]`, `[Auto]`), чтобы помочь пользователям различать бесплатные и ограниченные по запросам (платные) модели. Добавлена поддержка **Gemini 3.0 Pro** и **Gemini 2.0 Flash Lite**.
*   **Стабильность голосового ввода:** Значительно улучшена стабильность Умного голосового ввода. Добавлена проверка, игнорирующая аудиофрагменты короче 1 секунды, чтобы предотвратить «галлюцинации» ИИ и пустые ошибки.
*   **Работа с файлами:** Исправлена проблема, из-за которой загрузка файлов с неанглийскими именами завершалась ошибкой.
*   **Оптимизация запросов:** Улучшена логика перевода и структурированы результаты анализа изображений.

## Изменения в версии 2.9

*   **Добавлены переводы на французский и турецкий языки.**
*   **Форматированный вид:** Добавлена кнопка «Просмотреть с форматированием» в диалоговых окнах чата для просмотра диалога с правильным стилем (заголовки, жирный шрифт, код) в стандартном обозреваемом окне.
*   **Настройка Markdown:** Добавлена новая опция «Очищать Markdown в чате» в Настройках. Снятие этой галочки позволяет пользователям видеть необработанный синтаксис Markdown (например, `**`, `#`) в окне чата.
*   **Управление диалогами:** Исправлена проблема, из-за которой окна «Обработка текста» или чата могли открываться несколько раз или не получать фокус корректно.
*   **Улучшения UX:** Стандартизированы заголовки диалоговых окон файлов на «Открыть» и удалены лишние голосовые сообщения (например, «Открывается меню...») для более плавной работы.

## Изменения в версии 2.8
* Добавлен итальянский перевод.
* **Отчёт о состоянии:** Добавлена новая команда (NVDA+Control+Shift+I) для озвучивания текущего статуса дополнения (например, «Загрузка...», «Анализ...»).
* **Экспорт HTML:** Кнопка «Сохранить содержимое» в диалоговых окнах результатов теперь сохраняет вывод в виде форматированного HTML-файла, сохраняя стили, такие как заголовки и жирный текст.
* **Интерфейс настроек:** Улучшено расположение панели настроек с доступной группировкой элементов.
* **Новые модели:** Добавлена поддержка gemini-flash-latest и gemini-flash-lite-latest.
* **Языки:** Добавлен непальский язык в список поддерживаемых.
* **Логика меню обработки:** Исправлена критическая ошибка, из-за которой команды «Обработка текста» не работали, если язык интерфейса NVDA не был английским.
* **Голосовой ввод:** Улучшено определение тишины для предотвращения некорректного вывода текста, когда речь не вводится.
* **Настройки обновлений:** Опция «Проверять обновления при запуске» теперь по умолчанию отключена в соответствии с политиками Магазина дополнений.
* Рефакторинг кода.

## Изменения в версии 2.7
* Мигрирована структура проекта на официальный шаблон дополнений NV Access для лучшего соответствия стандартам.
* Реализована логика автоматического повтора при ошибках HTTP 429 (Превышен лимит запросов) для обеспечения надёжности при высокой нагрузке.
* Оптимизированы запросы для перевода для повышения точности и улучшения обработки логики «Умной замены».
* Обновлён русский перевод.

## Изменения в версии 2.6
* Добавлена поддержка русского перевода (благодаря nvda-ru).
* Обновлены сообщения об ошибках для более информативной обратной связи относительно подключения.
* Изменён целевой язык по умолчанию на английский.

## Изменения в версии 2.5
* Добавлена нативная команда OCR файла (NVDA+Control+Shift+F).
* Добавлена кнопка «Сохранить чат» в диалоговые окна результатов.
* Реализована полная поддержка локализации.
* Мигрированы звуковые сигналы на нативный модуль тонов NVDA.
* Переход на Gemini File API для лучшей обработки PDF и аудиофайлов.
* Исправлен сбой при переводе текста, содержащего фигурные скобки.

## Изменения в версии 2.1.1
* Исправлена проблема, из-за которой переменная `[file_ocr]` некорректно работала в Пользовательских запросах.

## Изменения в версии 2.1
* Все сочетания клавиш стандартизированы для использования NVDA+Control+Shift, чтобы устранить конфликты с раскладкой ноутбука NVDA и системными горячими клавишами.

## Изменения в версии 2.0
* Реализована встроенная система автоматического обновления.
* Добавлен Кэш умного перевода для мгновенного получения ранее переведённого текста.
* Добавлена Память диалога для контекстного уточнения результатов в окнах чата.
* Добавлена специальная команда перевода из буфера обмена (NVDA+Control+Shift+Y).
* Оптимизированы ИИ-запросы для строгого соблюдения вывода на целевом языке.
* Исправлен сбой, вызванный специальными символами во входном тексте.

## Изменения в версии 1.5
* Добавлена поддержка более 20 новых языков.
* Реализовано интерактивное диалоговое окно обработки для уточняющих вопросов.
* Добавлена нативная функция Умного голосового ввода.
* Добавлена категория «Vision Assistant» в диалог «Жесты ввода» NVDA.
* Исправлены сбои COMError в определённых приложениях, таких как Firefox и Word.
* Добавлен автоматический механизм повтора при ошибках сервера.

## Изменения в версии 1.0
* Первый выпуск.
